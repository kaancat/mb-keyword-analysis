<!DOCTYPE html>
<html lang="da">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Potentialeanalyse - {{CLIENT_NAME}}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- Monday Brew fonts: Inter for body, Plus Jakarta Sans for headings (similar to HeyWow/Sailec) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Monday Brew Brand Colors
                        brand: {
                            DEFAULT: '#49444b',      // mb-ink
                            light: '#f5f7fd',        // mb-bg
                            dark: '#121017'          // dark mode bg
                        },
                        accent: '#ff914d',           // mb-accent (warm orange)
                        ink: '#49444b',              // main text
                        bgsoft: '#f5f7fd',           // soft background
                        surface: {
                            DEFAULT: '#ffffff',
                            elevated: 'rgba(255, 255, 255, 0.8)'
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', '-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'sans-serif'],
                        heading: ['Plus Jakarta Sans', 'Inter', '-apple-system', 'sans-serif'],
                    },
                    borderRadius: {
                        'mb': '0.625rem',  // 10px - Monday Brew default
                        'mb-lg': '0.875rem', // 14px
                        'mb-xl': '1.25rem',  // 20px
                    },
                    boxShadow: {
                        'mb-sm': '0 2px 8px rgba(73, 68, 75, 0.06)',
                        'mb': '0 4px 16px rgba(73, 68, 75, 0.08)',
                        'mb-lg': '0 12px 32px rgba(73, 68, 75, 0.12)',
                        'mb-elevated': '0 24px 64px rgba(10, 10, 10, 0.08)',
                        'glass': '0 8px 32px rgba(73, 68, 75, 0.08)',
                    }
                }
            }
        }
    </script>
    <style>
        [v-cloak] { display: none; }
        .slide-enter-active, .slide-leave-active { transition: opacity 0.3s ease; }
        .slide-enter-from, .slide-leave-to { opacity: 0; }
        .animate-fade-in { animation: fadeIn 0.4s cubic-bezier(0.25, 0.62, 0.32, 1); }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: translateY(0); } }

        /* Monday Brew Glass Effect */
        .glass-surface {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(73, 68, 75, 0.08);
        }

        /* Accent gradient for highlights */
        .accent-gradient {
            background: linear-gradient(135deg, #ff914d 0%, #ffb380 100%);
        }

        /* Monday Brew text styles */
        .font-heading { font-family: 'Plus Jakarta Sans', 'Inter', sans-serif; }

        /* Subtle hover transitions */
        .mb-hover { transition: all 0.28s cubic-bezier(0.25, 0.62, 0.32, 1); }
        .mb-hover:hover { transform: translateY(-2px); box-shadow: 0 12px 32px rgba(73, 68, 75, 0.12); }

        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f5f7fd; }
        ::-webkit-scrollbar-thumb { background: rgba(73, 68, 75, 0.2); border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: rgba(73, 68, 75, 0.35); }
    </style>
</head>

<body class="bg-bgsoft text-ink font-sans h-screen flex overflow-hidden">

    <div id="app" v-cloak class="flex w-full h-full">

        <!-- Sidebar - Monday Brew Style -->
        <aside class="w-64 glass-surface shadow-mb-lg z-10 flex flex-col">
            <div class="p-6 border-b border-ink/5 flex flex-col items-center">
                <img v-if="clientLogo" :src="clientLogo" :alt="clientName" class="h-14 object-contain mb-3 drop-shadow-sm">
                <div v-else class="h-14 flex items-center justify-center text-xl font-heading font-bold text-ink mb-3">{{ clientName }}</div>
                <div class="text-[10px] font-semibold text-accent uppercase tracking-[0.15em]">Potentialeanalyse</div>
            </div>

            <nav class="flex-1 p-3 space-y-1 overflow-y-auto">
                <button @click="currentTab = 'summary'"
                    :class="{'bg-ink text-white shadow-mb': currentTab === 'summary', 'text-ink/70 hover:bg-ink/5 hover:text-ink': currentTab !== 'summary'}"
                    class="w-full text-left px-4 py-3 rounded-mb transition-all duration-200 flex items-center gap-3 font-medium text-sm">
                    <span class="text-lg">üìä</span> Executive Summary
                </button>
                <button @click="currentTab = 'roi'"
                    :class="{'bg-ink text-white shadow-mb': currentTab === 'roi', 'text-ink/70 hover:bg-ink/5 hover:text-ink': currentTab !== 'roi'}"
                    class="w-full text-left px-4 py-3 rounded-mb transition-all duration-200 flex items-center gap-3 font-medium text-sm">
                    <span class="text-lg">üßÆ</span> ROI Beregner
                </button>
                <button @click="currentTab = 'keywords'"
                    :class="{'bg-ink text-white shadow-mb': currentTab === 'keywords', 'text-ink/70 hover:bg-ink/5 hover:text-ink': currentTab !== 'keywords'}"
                    class="w-full text-left px-4 py-3 rounded-mb transition-all duration-200 flex items-center gap-3 font-medium text-sm">
                    <span class="text-lg">üîç</span> S√∏geordsanalyse
                </button>
                <button @click="currentTab = 'campaigns'"
                    :class="{'bg-ink text-white shadow-mb': currentTab === 'campaigns', 'text-ink/70 hover:bg-ink/5 hover:text-ink': currentTab !== 'campaigns'}"
                    class="w-full text-left px-4 py-3 rounded-mb transition-all duration-200 flex items-center gap-3 font-medium text-sm">
                    <span class="text-lg">üèóÔ∏è</span> Kampagnestruktur
                </button>
                <button @click="currentTab = 'ads'"
                    :class="{'bg-ink text-white shadow-mb': currentTab === 'ads', 'text-ink/70 hover:bg-ink/5 hover:text-ink': currentTab !== 'ads'}"
                    class="w-full text-left px-4 py-3 rounded-mb transition-all duration-200 flex items-center gap-3 font-medium text-sm">
                    <span class="text-lg">üì¢</span> Annonceeksempler
                </button>
            </nav>

            <div class="p-4 border-t border-ink/5 text-center">
                <div class="text-[10px] text-ink/50 uppercase tracking-wider mb-1">Udarbejdet af</div>
                <div class="font-heading font-semibold text-sm text-ink">mondaybrew</div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 overflow-y-auto bg-bgsoft p-8">

            <!-- Summary Tab -->
            <div v-if="currentTab === 'summary'" class="max-w-4xl mx-auto space-y-8 animate-fade-in">
                <header class="mb-8">
                    <div class="flex items-center gap-3 mb-4">
                        <span class="text-[11px] font-semibold text-accent uppercase tracking-[0.15em]">{{ clientTagline }}</span>
                        <span class="h-0.5 w-8 bg-accent rounded-full"></span>
                    </div>
                    <h1 class="text-3xl font-heading font-bold text-ink mb-3">Potentialeanalyse for {{ clientName }}</h1>
                    <p class="text-lg text-ink/60">{{ summarySubtitle }}</p>
                    <div class="mt-5 flex gap-3">
                        <a :href="clientCTA" target="_blank" class="px-5 py-2.5 rounded-mb accent-gradient text-white font-semibold shadow-mb mb-hover">Kontakt os</a>
                        <a :href="clientWebsite" target="_blank" class="px-5 py-2.5 rounded-mb border border-ink/15 text-ink font-medium hover:bg-white/50 transition">Bes√∏g website</a>
                    </div>
                </header>

                <!-- KPI Cards -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-5 mb-8">
                    <div class="bg-white/80 backdrop-blur-sm p-6 rounded-mb-lg shadow-mb border border-ink/5 mb-hover">
                        <div class="text-ink/60 font-medium text-sm mb-2">Estimeret Oms√¶tning</div>
                        <div class="text-3xl font-heading font-bold text-ink">{{ formatCurrency(roiOutputs.estimated_revenue) }}</div>
                        <div class="text-sm text-ink/50 mt-1">pr. m√•ned ved {{ formatCurrency(inputs.budget) }} budget</div>
                    </div>
                    <div class="bg-white/80 backdrop-blur-sm p-6 rounded-mb-lg shadow-mb border border-ink/5 mb-hover">
                        <div class="text-ink/60 font-medium text-sm mb-2">Estimeret ROAS</div>
                        <div class="text-3xl font-heading font-bold text-accent">{{ roiOutputs.roas }}</div>
                        <div class="text-sm text-ink/50 mt-1">Return on Ad Spend</div>
                    </div>
                    <div class="bg-white/80 backdrop-blur-sm p-6 rounded-mb-lg shadow-mb border border-ink/5 mb-hover">
                        <div class="text-ink/60 font-medium text-sm mb-2">Nye Kunder</div>
                        <div class="text-3xl font-heading font-bold text-ink">{{ roiOutputs.estimated_customers }}</div>
                        <div class="text-sm text-ink/50 mt-1">estimeret pr. m√•ned</div>
                    </div>
                </div>

                <!-- Executive Summary Card -->
                <div class="bg-white/90 backdrop-blur-sm p-8 rounded-mb-lg shadow-mb border border-ink/5 prose prose-slate max-w-none">
                    <h3 class="text-xl font-heading font-bold text-ink mb-4 flex items-center gap-2">
                        <span class="w-1 h-6 bg-accent rounded-full"></span>
                        Executive Summary
                    </h3>
                    <div class="text-ink/80 leading-relaxed" v-html="executiveSummary"></div>
                </div>
            </div>

            <!-- ROI Calculator Tab -->
            <div v-if="currentTab === 'roi'" class="max-w-6xl mx-auto animate-fade-in">
                <header class="mb-8">
                    <div class="flex items-center gap-3 mb-4">
                        <span class="text-[11px] font-semibold text-accent uppercase tracking-[0.15em]">Interaktiv</span>
                        <span class="h-0.5 w-8 bg-accent rounded-full"></span>
                    </div>
                    <h1 class="text-3xl font-heading font-bold text-ink mb-3">ROI Beregner</h1>
                    <p class="text-lg text-ink/60">Juster tallene herunder for at se potentialet baseret p√• jeres egne data.</p>
                </header>

                <!-- Interactive Input Controls -->
                <div class="bg-white/90 backdrop-blur-sm p-6 rounded-mb-lg shadow-mb border border-ink/5 mb-8">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-ink/80 mb-1">M√•nedligt Budget</label>
                            <div class="relative rounded-mb shadow-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <span class="text-ink/50 sm:text-sm">kr.</span>
                                </div>
                                <input type="number" v-model.number="inputs.budget"
                                    class="focus:ring-accent focus:border-accent block w-full pl-10 sm:text-sm border-ink/15 rounded-mb p-2.5 border bg-white/80">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-ink/80 mb-1">Fortjeneste pr. kunde</label>
                            <div class="relative rounded-mb shadow-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <span class="text-ink/50 sm:text-sm">kr.</span>
                                </div>
                                <input type="number" v-model.number="inputs.profit_per_customer"
                                    class="focus:ring-accent focus:border-accent block w-full pl-10 sm:text-sm border-ink/15 rounded-mb p-2.5 border bg-white/80">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-ink/80 mb-1">Estimeret CPC</label>
                            <div class="relative rounded-mb shadow-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <span class="text-ink/50 sm:text-sm">kr.</span>
                                </div>
                                <input type="number" v-model.number="estimates.cpc"
                                    class="focus:ring-accent focus:border-accent block w-full pl-10 sm:text-sm border-ink/15 rounded-mb p-2.5 border bg-white/80">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-ink/80 mb-1">Website konvertering</label>
                            <div class="flex items-center gap-2">
                                <input type="range" v-model.number="estimates.website_conv_rate" min="1" max="20" step="0.5"
                                    class="flex-1 h-2 bg-ink/10 rounded-lg appearance-none cursor-pointer accent-accent">
                                <span class="text-sm font-semibold text-ink w-12 text-right">{{ estimates.website_conv_rate }}%</span>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-ink/80 mb-1">Lukningsrate</label>
                            <div class="flex items-center gap-2">
                                <input type="range" v-model.number="inputs.close_rate" min="1" max="100"
                                    class="flex-1 h-2 bg-ink/10 rounded-lg appearance-none cursor-pointer accent-accent">
                                <span class="text-sm font-semibold text-ink w-12 text-right">{{ inputs.close_rate }}%</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Funnel Visualization -->
                <div class="bg-white/90 backdrop-blur-sm p-6 rounded-mb-lg shadow-mb border border-ink/5 mb-8">
                    <div class="flex flex-col md:flex-row items-center justify-center gap-4 md:gap-8">
                        <div class="bg-ink/5 px-6 py-4 rounded-mb text-center min-w-[140px]">
                            <div class="text-xs text-ink/60 uppercase tracking-wide font-semibold mb-1">Trafik</div>
                            <div class="text-2xl font-heading font-bold text-ink">{{ Math.round(roiOutputs.estimated_clicks) }}</div>
                            <div class="text-sm text-ink/60">bes√∏gende</div>
                        </div>
                        <div class="text-ink/30 text-2xl hidden md:block">‚Üí</div>
                        <div class="text-ink/30 text-2xl md:hidden">‚Üì</div>
                        <div class="bg-ink/5 px-6 py-4 rounded-mb text-center min-w-[140px]">
                            <div class="text-xs text-ink/60 uppercase tracking-wide font-semibold mb-1">Leads</div>
                            <div class="text-2xl font-heading font-bold text-ink">{{ roiOutputs.estimated_leads }}</div>
                            <div class="text-sm text-ink/60">henvendelser</div>
                        </div>
                        <div class="text-ink/30 text-2xl hidden md:block">‚Üí</div>
                        <div class="text-ink/30 text-2xl md:hidden">‚Üì</div>
                        <div class="accent-gradient px-6 py-4 rounded-mb text-center min-w-[140px] shadow-mb">
                            <div class="text-xs text-white/90 uppercase tracking-wide font-semibold mb-1">Nye Kunder</div>
                            <div class="text-3xl font-heading font-bold text-white">{{ roiOutputs.estimated_customers }}</div>
                            <div class="text-sm text-white/80">pr. m√•ned</div>
                        </div>
                    </div>
                </div>

                <!-- ROI Table -->
                <div class="bg-white/90 backdrop-blur-sm rounded-mb-lg shadow-mb border border-ink/5 overflow-hidden">
                    <table class="w-full">
                        <thead>
                            <tr class="bg-ink/3 border-b border-ink/10">
                                <th class="px-6 py-4 text-left text-sm font-semibold text-ink/80 w-1/4">Label</th>
                                <th class="px-6 py-4 text-left text-sm font-semibold text-ink/80 w-1/6">V√¶rdi</th>
                                <th class="px-6 py-4 text-left text-sm font-semibold text-ink/80 w-1/4">Hvad betyder det?</th>
                                <th class="px-6 py-4 text-left text-sm font-semibold text-ink/80 w-1/3">Beregning</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="bg-ink text-white">
                                <td class="px-6 py-3 font-bold text-sm" colspan="4">üìä DINE TAL</td>
                            </tr>
                            <tr v-for="row in roiTable.inputs" :key="'input-' + row.label" class="border-b border-ink/5 hover:bg-ink/3">
                                <td class="px-6 py-3 text-sm text-ink">{{ row.label }}</td>
                                <td class="px-6 py-3 text-sm font-bold text-ink bg-accent/10">{{ row.value }}</td>
                                <td class="px-6 py-3 text-sm text-ink/60 italic">{{ row.note }}</td>
                                <td class="px-6 py-3 text-sm text-ink/40">‚Äî</td>
                            </tr>
                            <tr class="bg-ink/80 text-white">
                                <td class="px-6 py-3 font-bold text-sm" colspan="4">üìà KAMPAGNE ESTIMATER</td>
                            </tr>
                            <tr v-for="row in roiTable.estimates" :key="'est-' + row.label" class="border-b border-ink/5 hover:bg-ink/3">
                                <td class="px-6 py-3 text-sm text-ink">{{ row.label }}</td>
                                <td class="px-6 py-3 text-sm font-bold text-ink bg-accent/10">{{ row.value }}</td>
                                <td class="px-6 py-3 text-sm text-ink/60 italic">{{ row.note }}</td>
                                <td class="px-6 py-3 text-sm text-ink/40">‚Äî</td>
                            </tr>
                            <tr class="accent-gradient text-white">
                                <td class="px-6 py-3 font-bold text-sm" colspan="4">üßÆ BEREGNEDE RESULTATER</td>
                            </tr>
                            <tr v-for="row in roiTable.results" :key="'res-' + row.label" class="border-b border-ink/5 hover:bg-accent/5">
                                <td class="px-6 py-3 text-sm text-ink">{{ row.label }}</td>
                                <td class="px-6 py-3 text-sm font-bold text-ink">{{ row.value }}</td>
                                <td class="px-6 py-3 text-sm text-ink/60 italic">{{ row.note }}</td>
                                <td class="px-6 py-3 text-sm text-ink/50 font-mono text-xs">{{ row.calc }}</td>
                            </tr>
                            <tr class="border-t-2 border-ink/15">
                                <td class="px-6 py-4 font-heading font-bold text-ink">STATUS</td>
                                <td class="px-6 py-4 font-bold text-lg"
                                    :class="roiOutputs.estimated_profit >= 0 ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'">
                                    {{ roiOutputs.estimated_profit >= 0 ? '‚úÖ Profitable' : '‚ùå Ikke profitable' }}
                                </td>
                                <td class="px-6 py-4 text-sm text-ink/60" colspan="2">
                                    {{ roiOutputs.estimated_profit >= 0 ? 'Du tjener penge p√• Google Ads!' : 'Just√©r dine tal for at opn√• profitabilitet.' }}
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Keywords Tab -->
            <div v-if="currentTab === 'keywords'" class="max-w-5xl mx-auto animate-fade-in">
                <header class="mb-8 flex justify-between items-end">
                    <div>
                        <div class="flex items-center gap-3 mb-4">
                            <span class="text-[11px] font-semibold text-accent uppercase tracking-[0.15em]">Research</span>
                            <span class="h-0.5 w-8 bg-accent rounded-full"></span>
                        </div>
                        <h1 class="text-3xl font-heading font-bold text-ink mb-3">S√∏geordsanalyse</h1>
                        <p class="text-lg text-ink/60">Hvad s√∏ger dine potentielle kunder efter?</p>
                    </div>
                    <div class="bg-white/90 backdrop-blur-sm px-4 py-2 rounded-mb shadow-mb border border-ink/5 text-sm">
                        <span class="font-bold text-accent">{{ keywords.length }}</span> s√∏geord fundet
                    </div>
                </header>

                <!-- Match Type Distribution -->
                <div class="bg-white/90 backdrop-blur-sm p-4 rounded-mb-lg shadow-mb border border-ink/5 mb-6" v-if="matchTypeDist && matchTypeDist.counts">
                    <div class="flex flex-wrap gap-6 items-center justify-between">
                        <div class="flex gap-4">
                            <div class="flex items-center gap-2" v-if="matchTypeDist.counts.Exact > 0">
                                <span class="px-2 py-1 text-xs font-semibold rounded-full bg-purple-100 text-purple-800">Exact</span>
                                <span class="text-sm text-ink/60">{{ matchTypeDist.counts.Exact }} ({{ matchTypeDist.percentages.Exact }}%)</span>
                            </div>
                            <div class="flex items-center gap-2" v-if="matchTypeDist.counts.Phrase > 0">
                                <span class="px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800">Phrase</span>
                                <span class="text-sm text-ink/60">{{ matchTypeDist.counts.Phrase }} ({{ matchTypeDist.percentages.Phrase }}%)</span>
                            </div>
                            <div class="flex items-center gap-2" v-if="matchTypeDist.counts.Broad > 0">
                                <span class="px-2 py-1 text-xs font-semibold rounded-full bg-orange-100 text-orange-800">Broad</span>
                                <span class="text-sm text-ink/60">{{ matchTypeDist.counts.Broad }} ({{ matchTypeDist.percentages.Broad }}%)</span>
                            </div>
                        </div>
                        <div class="text-sm text-ink/50">Match Type fordeling</div>
                    </div>
                </div>

                <!-- Keyword filter -->
                <div class="bg-white/90 backdrop-blur-sm p-4 rounded-mb-lg shadow-mb border border-ink/5 mb-6">
                    <div class="flex flex-wrap gap-4 items-center">
                        <input type="text" v-model="keywordSearch" placeholder="S√∏g s√∏geord..."
                            class="flex-1 min-w-[200px] px-4 py-2.5 border border-ink/15 rounded-mb focus:ring-accent focus:border-accent bg-white/80">
                        <select v-model="categoryFilter" class="px-4 py-2.5 border border-ink/15 rounded-mb focus:ring-accent focus:border-accent bg-white/80">
                            <option value="">Alle kategorier</option>
                            <option v-for="cat in uniqueCategories" :key="cat" :value="cat">{{ cat }}</option>
                        </select>
                    </div>
                </div>

                <div class="bg-white/90 backdrop-blur-sm rounded-mb-lg shadow-mb border border-ink/5 overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-ink/10">
                            <thead class="bg-ink/3">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-ink/70 uppercase tracking-wider">S√∏geord</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-ink/70 uppercase tracking-wider">Match Type</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-ink/70 uppercase tracking-wider">M√•nedlige S√∏gninger</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-ink/70 uppercase tracking-wider">Konkurrence</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-ink/70 uppercase tracking-wider">Top bud (lav)</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-ink/70 uppercase tracking-wider">Top bud (h√∏j)</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-ink/70 uppercase tracking-wider">Kategori</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white/50 divide-y divide-ink/5">
                                <tr v-for="(kw, index) in filteredKeywords" :key="index" class="hover:bg-ink/3 transition-colors">
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-ink">{{ kw.Keyword || kw.keyword }}</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm">
                                        <span :class="getMatchTypeClass(kw['Match Type'] || kw.match_type)"
                                            class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full">
                                            {{ kw['Match Type'] || kw.match_type || 'Phrase' }}
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-ink/70">
                                        <div class="flex items-center">
                                            <div class="w-16 bg-ink/10 rounded-full h-1.5 mr-2">
                                                <div class="bg-accent h-1.5 rounded-full" :style="{ width: Math.min(100, ((kw['Avg. Monthly Searches'] || kw.avg_monthly_searches || 0) / maxVolume) * 100) + '%' }"></div>
                                            </div>
                                            {{ kw['Avg. Monthly Searches'] || kw.avg_monthly_searches || 0 }}
                                        </div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm">
                                        <span :class="getCompetitionClass(kw.Competition || kw.competition)"
                                            class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full">
                                            {{ kw.Competition || kw.competition || 'N/A' }}
                                        </span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-ink/70">{{ formatBid(kw['Top of page bid (low range)'] || kw.low_top_of_page_bid) }}</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-ink/70">{{ formatBid(kw['Top of page bid (high range)'] || kw.high_top_of_page_bid) }}</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-ink/70">{{ kw.Category || kw.category || 'N/A' }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Negative Keywords Section -->
                <div class="bg-white/90 backdrop-blur-sm p-6 rounded-mb-lg shadow-mb border border-ink/5 mt-8" v-if="negativeKeywords && Object.keys(negativeKeywords).length > 0">
                    <h3 class="text-xl font-heading font-bold text-ink mb-4 flex items-center gap-2">
                        <span class="w-1 h-6 bg-red-500 rounded-full"></span>
                        Negative s√∏geord
                    </h3>
                    <p class="text-sm text-ink/60 mb-4">Disse s√∏geord vil blive ekskluderet for at undg√• irrelevant trafik og spildt budget.</p>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <!-- Global Negatives -->
                        <div v-if="negativeKeywords.global && negativeKeywords.global.length > 0" class="border border-ink/10 rounded-mb p-4 bg-white/50">
                            <h4 class="font-semibold text-ink mb-3 flex items-center gap-2">
                                <span class="w-2 h-2 bg-red-500 rounded-full"></span>
                                Globale negative
                            </h4>
                            <div class="flex flex-wrap gap-2">
                                <span v-for="kw in negativeKeywords.global" :key="kw"
                                    class="inline-flex items-center px-2 py-1 rounded-mb text-xs font-medium bg-red-50 text-red-700 border border-red-200">
                                    -{{ kw }}
                                </span>
                            </div>
                        </div>

                        <!-- Vertical/Industry Negatives -->
                        <div v-if="negativeKeywords.vertical_b2b && negativeKeywords.vertical_b2b.length > 0" class="border border-ink/10 rounded-mb p-4 bg-white/50">
                            <h4 class="font-semibold text-ink mb-3 flex items-center gap-2">
                                <span class="w-2 h-2 bg-orange-500 rounded-full"></span>
                                B2B negative
                            </h4>
                            <div class="flex flex-wrap gap-2">
                                <span v-for="kw in negativeKeywords.vertical_b2b" :key="kw"
                                    class="inline-flex items-center px-2 py-1 rounded-mb text-xs font-medium bg-orange-50 text-orange-700 border border-orange-200">
                                    -{{ kw }}
                                </span>
                            </div>
                        </div>

                        <!-- Client-Specific Negatives -->
                        <div v-if="negativeKeywords.client_specific && negativeKeywords.client_specific.length > 0" class="border border-ink/10 rounded-mb p-4 bg-white/50">
                            <h4 class="font-semibold text-ink mb-3 flex items-center gap-2">
                                <span class="w-2 h-2 bg-purple-500 rounded-full"></span>
                                Kundespecifikke negative
                            </h4>
                            <div class="flex flex-wrap gap-2">
                                <span v-for="kw in negativeKeywords.client_specific" :key="kw"
                                    class="inline-flex items-center px-2 py-1 rounded-mb text-xs font-medium bg-purple-50 text-purple-700 border border-purple-200">
                                    -{{ kw }}
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- Campaign-specific negative lists -->
                    <div v-if="negativeKeywords.campaign_negative_lists && Object.keys(negativeKeywords.campaign_negative_lists).length > 0" class="mt-6">
                        <h4 class="font-semibold text-ink mb-3">Kampagne-specifikke negative lister</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div v-for="(keywords, campaign) in negativeKeywords.campaign_negative_lists" :key="campaign" class="border border-ink/10 rounded-mb p-3 bg-ink/3">
                                <div class="text-sm font-medium text-ink/80 mb-2">{{ formatCampaignName(campaign) }}</div>
                                <div class="flex flex-wrap gap-1">
                                    <span v-for="kw in keywords" :key="kw"
                                        class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-ink/5 text-ink/70 border border-ink/10">
                                        -{{ kw }}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Campaigns Tab -->
            <div v-if="currentTab === 'campaigns'" class="max-w-5xl mx-auto animate-fade-in">
                <header class="mb-8">
                    <div class="flex items-center gap-3 mb-4">
                        <span class="text-[11px] font-semibold text-accent uppercase tracking-[0.15em]">Struktur</span>
                        <span class="h-0.5 w-8 bg-accent rounded-full"></span>
                    </div>
                    <h1 class="text-3xl font-heading font-bold text-ink mb-3">Kampagnestruktur</h1>
                    <p class="text-lg text-ink/60">Hvordan vi organiserer kontoen for maksimal effektivitet.</p>
                </header>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div v-for="(group, campaignName) in groupedCampaigns" :key="campaignName"
                        class="bg-white/90 backdrop-blur-sm rounded-mb-lg shadow-mb border border-ink/5 overflow-hidden mb-hover">
                        <div class="bg-ink/3 px-6 py-4 border-b border-ink/10 flex justify-between items-center">
                            <h3 class="font-heading font-bold text-ink">{{ formatCampaignName(campaignName) }}</h3>
                            <span class="bg-accent/10 text-accent text-xs font-semibold px-2.5 py-0.5 rounded-mb">Campaign</span>
                        </div>
                        <div class="p-6">
                            <div v-for="(keywords, adGroup) in group" :key="adGroup" class="mb-6 last:mb-0">
                                <div class="flex items-center mb-3">
                                    <div class="w-2 h-2 bg-accent rounded-full mr-2"></div>
                                    <h4 class="font-medium text-ink">{{ adGroup }}</h4>
                                </div>
                                <div class="ml-4 flex flex-wrap gap-2">
                                    <span v-for="kw in keywords.slice(0, 8)" :key="kw"
                                        class="inline-flex items-center px-2.5 py-0.5 rounded-mb text-xs font-medium bg-ink/5 text-ink/80 border border-ink/10">
                                        "{{ kw }}"
                                    </span>
                                    <span v-if="keywords.length > 8" class="text-xs text-ink/50 self-center">
                                        +{{ keywords.length - 8 }} mere
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ads Tab -->
            <div v-if="currentTab === 'ads'" class="max-w-4xl mx-auto animate-fade-in">
                <header class="mb-8">
                    <div class="flex items-center gap-3 mb-4">
                        <span class="text-[11px] font-semibold text-accent uppercase tracking-[0.15em]">Preview</span>
                        <span class="h-0.5 w-8 bg-accent rounded-full"></span>
                    </div>
                    <h1 class="text-3xl font-heading font-bold text-ink mb-3">Annonceeksempler</h1>
                    <p class="text-lg text-ink/60">Hvordan dine annoncer vil se ud p√• Google.</p>
                </header>

                <div class="space-y-6">
                    <div v-for="(ad, index) in ads" :key="index"
                        class="bg-white/90 backdrop-blur-sm p-6 rounded-mb-lg shadow-mb border border-ink/5 mb-hover">
                        <div class="text-xs text-accent mb-4 uppercase tracking-[0.1em] font-semibold">{{ formatCampaignName(ad.Campaign || ad.campaign) }}</div>

                        <!-- Google Ad Preview -->
                        <div class="font-sans max-w-xl bg-white p-4 rounded-mb border border-ink/10">
                            <div class="flex items-center gap-1 mb-1">
                                <span class="font-bold text-ink text-sm">Annonce</span>
                                <span class="text-green-700 text-sm">¬∑ {{ ad['Final URL'] || ad.final_url }}</span>
                            </div>
                            <div class="text-[#1a0dab] text-xl hover:underline cursor-pointer mb-1 leading-snug">
                                {{ formatHeadline(ad['Headline 1'] || ad.headline_1) }} | {{ ad['Headline 2'] || ad.headline_2 }} | {{ ad['Headline 3'] || ad.headline_3 }}
                            </div>
                            <div class="text-[#4d5156] text-sm leading-relaxed">
                                {{ ad['Description 1'] || ad.description_1 }} {{ ad['Description 2'] || ad.description_2 }}
                            </div>

                            <!-- Sitelink extensions mock -->
                            <div class="mt-4 flex gap-4 text-[#1a0dab] text-sm">
                                <span class="hover:underline cursor-pointer">Kontakt os</span>
                                <span class="hover:underline cursor-pointer">Vores services</span>
                                <span class="hover:underline cursor-pointer">Om os</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <script>
        const { createApp, ref, computed, reactive } = Vue;

        createApp({
            setup() {
                const currentTab = ref('summary');
                const keywordSearch = ref('');
                const categoryFilter = ref('');

                // --- DATA INJECTION START ---
                const clientName = '{{CLIENT_NAME}}';
                const clientLogo = '{{CLIENT_LOGO}}';
                const clientTagline = '{{CLIENT_TAGLINE}}';
                const clientWebsite = '{{CLIENT_WEBSITE}}';
                const clientCTA = '{{CLIENT_CTA}}';
                const summarySubtitle = '{{SUMMARY_SUBTITLE}}';
                const executiveSummary = `{{EXECUTIVE_SUMMARY}}`;

                const keywords = {{KEYWORDS_JSON}};
                const campaignStructure = {{CAMPAIGN_STRUCTURE_JSON}};
                const ads = {{ADS_JSON}};
                const matchTypeDist = {{MATCH_TYPE_DIST_JSON}};
                const negativeKeywords = {{NEGATIVE_KEYWORDS_JSON}};

                const inputs = reactive({
                    budget: {{BUDGET}},
                    profit_per_customer: {{PROFIT_PER_CUSTOMER}},
                    close_rate: {{CLOSE_RATE}}
                });

                const estimates = reactive({
                    cpc: {{CPC}},
                    website_conv_rate: {{CONVERSION_RATE}}
                });
                // --- DATA INJECTION END ---

                const maxVolume = computed(() => {
                    return Math.max(...keywords.map(k => k['Avg. Monthly Searches'] || k.avg_monthly_searches || 0), 1);
                });

                const uniqueCategories = computed(() => {
                    const cats = new Set(keywords.map(k => k.Category || k.category).filter(Boolean));
                    return [...cats].sort();
                });

                const filteredKeywords = computed(() => {
                    return keywords.filter(kw => {
                        const keyword = (kw.Keyword || kw.keyword || '').toLowerCase();
                        const category = kw.Category || kw.category || '';
                        const matchesSearch = !keywordSearch.value || keyword.includes(keywordSearch.value.toLowerCase());
                        const matchesCategory = !categoryFilter.value || category === categoryFilter.value;
                        return matchesSearch && matchesCategory;
                    });
                });

                const roiOutputs = computed(() => {
                    const clicks = inputs.budget / estimates.cpc;
                    const leads = clicks * (estimates.website_conv_rate / 100);
                    const customers = leads * (inputs.close_rate / 100);
                    const revenue = customers * inputs.profit_per_customer;
                    const profit = revenue - inputs.budget;
                    const roas = inputs.budget > 0 ? (revenue / inputs.budget).toFixed(2) + 'x' : '0x';

                    return {
                        estimated_clicks: clicks,
                        estimated_leads: Number(leads.toFixed(1)),
                        estimated_customers: Number(customers.toFixed(1)),
                        estimated_revenue: revenue,
                        estimated_profit: profit,
                        roas: roas
                    };
                });

                const formatCurrency = (value) => {
                    return new Intl.NumberFormat('da-DK', { style: 'currency', currency: '{{CURRENCY}}', maximumFractionDigits: 0 }).format(value);
                };

                const formatBid = (bid) => {
                    if (!bid) return '-';
                    if (typeof bid === 'string') return bid;
                    return formatCurrency(bid);
                };

                const getCompetitionClass = (comp) => {
                    const level = (comp || '').toLowerCase();
                    if (level === 'high') return 'bg-red-100 text-red-800';
                    if (level === 'medium') return 'bg-yellow-100 text-yellow-800';
                    if (level === 'low') return 'bg-green-100 text-green-800';
                    return 'bg-gray-100 text-gray-800';
                };

                const getMatchTypeClass = (matchType) => {
                    const type = (matchType || '').toLowerCase();
                    if (type === 'exact') return 'bg-purple-100 text-purple-800';
                    if (type === 'phrase') return 'bg-blue-100 text-blue-800';
                    if (type === 'broad') return 'bg-orange-100 text-orange-800';
                    return 'bg-gray-100 text-gray-800';
                };

                const formatCampaignName = (name) => {
                    if (!name) return '';
                    return name.replace(/^mb \| [A-Z]{2} \| [^|]+ \| /, '');
                };

                const formatHeadline = (headline) => {
                    if (!headline) return '';
                    return headline.replace(/{KeyWord:([^}]+)}/, '$1').replace(/{LOCATION\(City\):([^}]+)}/, '$1');
                };

                const roiTable = computed(() => {
                    const clicks = Math.round(roiOutputs.value.estimated_clicks);
                    const leads = roiOutputs.value.estimated_leads;
                    const customers = roiOutputs.value.estimated_customers;
                    const revenue = roiOutputs.value.estimated_revenue;
                    const profit = roiOutputs.value.estimated_profit;
                    return {
                        inputs: [
                            { label: 'M√•nedligt annoncebudget', value: formatCurrency(inputs.budget), note: 'Hvor meget vil du bruge p√• Google Ads?', calc: '' },
                            { label: 'Fortjeneste pr. kunde', value: formatCurrency(inputs.profit_per_customer), note: 'Hvad tjener du p√• √©n kunde?', calc: '' },
                            { label: 'Lukningsrate %', value: inputs.close_rate + '%', note: 'Hvor mange % af dine henvendelser bliver til salg?', calc: '' },
                        ],
                        estimates: [
                            { label: 'Pris pr. klik (CPC)', value: formatCurrency(estimates.cpc), note: 'Hvad koster √©t klik p√• din annonce?', calc: '' },
                            { label: 'Website konverteringsrate %', value: estimates.website_conv_rate + '%', note: 'Hvor mange % af bes√∏gende udfylder formularen?', calc: '' },
                        ],
                        results: [
                            { label: 'Estimerede klik/m√•ned', value: clicks, note: 'Hvor mange klik kan du k√∏be for dit budget?', calc: `${formatCurrency(inputs.budget)} √∑ ${formatCurrency(estimates.cpc)} pr. klik = ${clicks} klik` },
                            { label: 'Estimerede leads/m√•ned', value: leads, note: 'Hvor mange udfylder kontaktformularen?', calc: `${clicks} klik √ó ${estimates.website_conv_rate}% = ${leads} leads` },
                            { label: 'Estimerede kunder/m√•ned', value: customers, note: 'Hvor mange leads bliver til betalende kunder?', calc: `${leads} leads √ó ${inputs.close_rate}% = ${customers} kunder` },
                            { label: 'Estimeret oms√¶tning/m√•ned', value: formatCurrency(revenue), note: 'Hvad tjener du p√• disse kunder?', calc: `${customers} kunder √ó ${formatCurrency(inputs.profit_per_customer)} = ${formatCurrency(revenue)}` },
                            { label: 'Estimeret profit/m√•ned', value: formatCurrency(profit), note: 'Din fortjeneste efter annonceudgifter', calc: `${formatCurrency(revenue)} ‚àí ${formatCurrency(inputs.budget)} = ${formatCurrency(profit)}` },
                            { label: 'ROAS (Return on Ad Spend)', value: roiOutputs.value.roas, note: 'For hver 1 kr brugt, f√•r du X kr tilbage', calc: `${formatCurrency(revenue)} √∑ ${formatCurrency(inputs.budget)} = ${roiOutputs.value.roas}` },
                        ]
                    };
                });

                const groupedCampaigns = computed(() => {
                    const groups = {};
                    campaignStructure.forEach(item => {
                        const campaign = item.Campaign || item.campaign;
                        const adGroup = item['Ad Group'] || item.ad_group;
                        const keyword = item.Keyword || item.keyword;
                        if (!groups[campaign]) {
                            groups[campaign] = {};
                        }
                        if (!groups[campaign][adGroup]) {
                            groups[campaign][adGroup] = [];
                        }
                        if (!groups[campaign][adGroup].includes(keyword)) {
                            groups[campaign][adGroup].push(keyword);
                        }
                    });
                    return groups;
                });

                return {
                    currentTab,
                    keywordSearch,
                    categoryFilter,
                    clientName,
                    clientLogo,
                    clientTagline,
                    clientWebsite,
                    clientCTA,
                    summarySubtitle,
                    executiveSummary,
                    inputs,
                    estimates,
                    roiOutputs,
                    roiTable,
                    keywords,
                    filteredKeywords,
                    uniqueCategories,
                    maxVolume,
                    groupedCampaigns,
                    ads,
                    matchTypeDist,
                    negativeKeywords,
                    formatCurrency,
                    formatBid,
                    getCompetitionClass,
                    getMatchTypeClass,
                    formatCampaignName,
                    formatHeadline
                };
            }
        }).mount('#app');
    </script>
</body>

</html>
